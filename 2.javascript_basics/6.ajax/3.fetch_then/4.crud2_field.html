<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSONPlaceholder Example</title>
    <style>
        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            margin: 20px;
            line-height: 1.5;
        }
        h2 {
            margin-bottom: 16px;
        }
        .section {
            border: 1px solid #ddd;
            padding: 12px 16px;
            margin-bottom: 16px;
            border-radius: 8px;
        }
        .section h3 {
            margin-top: 0;
        }
        label {
            display: inline-block;
            margin: 4px 0;
        }
        input[type="number"],
        input[type="text"],
        textarea {
            padding: 4px 6px;
            margin-left: 4px;
        }
        textarea {
            width: 100%;
            min-height: 60px;
        }
        button {
            margin-top: 6px;
            margin-right: 6px;
            padding: 4px 10px;
        }
        #result {
            white-space: pre-wrap;
            background: #f5f5f5;
            padding: 10px;
            border-radius: 8px;
            min-height: 50px;
            font-family: "Fira Code", monospace;
        }
    </style>
</head>
<body>
    <h2>JSONPlaceholder API Example</h2>
    
    <!-- Create -->
    <div class="section">
        <h3>Create a Post</h3>
        <div>
            <label>
                Title:
                <input type="text" id="createTitleInput" value="foo">
            </label>
        </div>
        <div>
            <label>
                Body:
                <input type="text" id="createBodyInput" value="bar">
            </label>
        </div>
        <div>
            <label>
                User ID:
                <input type="number" id="createUserIdInput" value="1" min="1">
            </label>
        </div>
        <button id="createPostBtn">Create Post</button>
    </div>

    <!-- Retrieve -->
    <div class="section">
        <h3>Retrieve a Post</h3>
        <div>
            <label>
                Post ID:
                <input type="number" id="postIdInput" value="1" min="1" max="100">
            </label>
        </div>
        <button id="prevPostBtn">&lt; Prev</button>
        <button id="retrievePostBtn">Retrieve</button>
        <button id="nextPostBtn">Next &gt;</button>
    </div>

    <!-- Update -->
    <div class="section">
        <h3>Update a Post</h3>
        <div>
            <label>
                Post ID:
                <input type="number" id="updatePostIdInput" value="1" min="1" max="100">
            </label>
        </div>
        <div>
            <label>
                Title:
                <input type="text" id="updateTitleInput" value="updated title">
            </label>
        </div>
        <div>
            <label>Body:</label><br>
            <textarea id="updateBodyInput">updated body</textarea>
        </div>
        <div>
            <label>
                User ID:
                <input type="number" id="updateUserIdInput" value="1" min="1">
            </label>
        </div>
        <button id="updatePostBtn">Update Post</button>
    </div>

    <!-- Delete -->
    <div class="section">
        <h3>Delete a Post</h3>
        <div>
            <label>
                Post ID:
                <input type="number" id="deletePostIdInput" value="1" min="1" max="100">
            </label>
        </div>
        <button id="deletePostBtn">Delete Post</button>
    </div>

    <!-- Result -->
    <div class="section">
        <h3>Result:</h3>
        <div id="result"></div>
    </div>

    <script>
        const BASE_URL = 'https://jsonplaceholder.typicode.com/posts';
        const resultDiv = document.getElementById('result');

        // 공통: 결과 출력 함수
        function showResult(data) {
            resultDiv.innerText = JSON.stringify(data, null, 2);
        }

        function showError(err) {
            resultDiv.innerText = '에러가 발생했습니다.\n' + err;
        }

        /***********************
         * Create Post
         ***********************/
        document.getElementById('createPostBtn').addEventListener('click', function() {
            const title = document.getElementById('createTitleInput').value;
            const body = document.getElementById('createBodyInput').value;
            const userId = Number(document.getElementById('createUserIdInput').value) || 1;

            const postData = { title, body, userId };

            fetch(BASE_URL, {
                method: 'POST',
                headers: {
                    'Content-type': 'application/json; charset=UTF-8',
                },
                body: JSON.stringify(postData),
            })
            .then(response => response.json())
            .then(showResult)
            .catch(showError);
        });

        /***********************
         * Retrieve Post + Prev/Next
         ***********************/
        const postIdInput = document.getElementById('postIdInput');
        const retrieveBtn = document.getElementById('retrievePostBtn');
        const prevBtn = document.getElementById('prevPostBtn');
        const nextBtn = document.getElementById('nextPostBtn');

        // 지정한 id로 게시글 조회
        function loadPostById(id) {
            // id 범위 제한 (JSONPlaceholder posts: 1~100)
            if (id < 1 || id > 100) {
                alert('Post ID는 1 이상 100 이하만 사용 가능합니다.');
                return;
            }

            fetch(`${BASE_URL}/${id}`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Post not found (status: ' + response.status + ')');
                    }
                    return response.json();
                })
                .then(json => {
                    showResult(json);
                    // 조회에 성공하면 입력 박스도 현재 id로 맞춰줌
                    postIdInput.value = json.id;
                })
                .catch(showError);
        }

        // Retrieve 버튼 클릭
        retrieveBtn.addEventListener('click', function() {
            const id = Number(postIdInput.value) || 1;
            loadPostById(id);
        });

        // Prev 버튼 클릭
        prevBtn.addEventListener('click', function() {
            let id = Number(postIdInput.value) || 1;
            if (id > 1) {
                id -= 1;
                postIdInput.value = id;
                loadPostById(id);
            } else {
                alert('이미 가장 첫 번째 글입니다. (ID = 1)');
            }
        });

        // Next 버튼 클릭
        nextBtn.addEventListener('click', function() {
            let id = Number(postIdInput.value) || 1;
            if (id < 100) {
                id += 1;
                postIdInput.value = id;
                loadPostById(id);
            } else {
                alert('이미 가장 마지막 글입니다. (ID = 100)');
            }
        });

        /***********************
         * Update Post
         ***********************/
        document.getElementById('updatePostBtn').addEventListener('click', function() {
            const id = Number(document.getElementById('updatePostIdInput').value);
            const title = document.getElementById('updateTitleInput').value;
            const body = document.getElementById('updateBodyInput').value;
            const userId = Number(document.getElementById('updateUserIdInput').value) || 1;

            if (!id || id < 1 || id > 100) {
                alert('수정할 Post ID를 1~100 사이로 입력해주세요.');
                return;
            }

            const updateData = { id, title, body, userId };

            fetch(`${BASE_URL}/${id}`, {
                method: 'PUT',
                headers: {
                    'Content-type': 'application/json; charset=UTF-8',
                },
                body: JSON.stringify(updateData),
            })
            .then(response => response.json())
            .then(showResult)
            .catch(showError);
        });

        /***********************
         * Delete Post
         ***********************/
        document.getElementById('deletePostBtn').addEventListener('click', function() {
            const id = Number(document.getElementById('deletePostIdInput').value);

            if (!id || id < 1 || id > 100) {
                alert('삭제할 Post ID를 1~100 사이로 입력해주세요.');
                return;
            }

            fetch(`${BASE_URL}/${id}`, {
                method: 'DELETE',
            })
            .then(response => {
                // JSONPlaceholder에서는 DELETE 응답이 빈 객체 {}
                if (!response.ok) {
                    throw new Error('삭제 실패 (status: ' + response.status + ')');
                }
                return response.json();
            })
            .then(json => {
                showResult({ message: `Post ${id} deleted (mock)`, response: json });
            })
            .catch(showError);
        });
    </script>
</body>
</html>
