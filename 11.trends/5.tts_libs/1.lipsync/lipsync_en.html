<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text to Lip Sync</title>
    <style>
        #character {
            font-size: 100px;
            text-align: center;
            margin-top: 50px;
        }
        #log {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <textarea id="textInput" placeholder="í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”" rows="4" cols="50"></textarea>
    <button id="speakButton">ë§í•˜ê¸°</button>
    <div id="character">ğŸ˜€</div>
    <div id="log"></div>

    <script>
        const textInput = document.getElementById('textInput');
        const speakButton = document.getElementById('speakButton');
        const character = document.getElementById('character');
        const log = document.getElementById('log');

        const lipsyncMap = {
            'a': 'ğŸ˜®', // ì… ë²Œë¦° ëª¨ì–‘
            'e': 'ğŸ˜', // ì¤‘ë¦½ ëª¨ì–‘
            'i': 'ğŸ˜Š', // ì›ƒëŠ” ëª¨ì–‘
            'o': 'ğŸ˜¯', // ë†€ë€ ëª¨ì–‘
            'u': 'ğŸ˜²'  // ë†€ë€ ëª¨ì–‘
        };

        let voices = [];

        const loadVoices = () => {
            voices = window.speechSynthesis.getVoices();
        };
        
        loadVoices();
        if (speechSynthesis.onvoiceschanged !== undefined) {
            speechSynthesis.onvoiceschanged = loadVoices;
        }

        speakButton.addEventListener('click', () => {
            // ì´ì „ ë¡œê·¸ ë‚´ìš© í´ë¦¬ì–´
            log.innerHTML = '';

            const text = textInput.value;
            if (!text) return;

            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'ko-KR';

            utterance.onboundary = (event) => {
                if (event.name === 'word') {
                    const word = text.slice(event.charIndex, event.charIndex + event.charLength);
                    const char = word.toLowerCase().match(/[aeiou]/);
                    const vowel = char ? char[0] : null;
                    const emoji = vowel ? lipsyncMap[vowel] : 'ğŸ˜€';

                    character.textContent = emoji;

                    const logEntry = document.createElement('div');
                    logEntry.textContent = `Word: ${word}, Vowel: ${vowel}, Emoji: ${emoji}`;
                    log.appendChild(logEntry);
                }
            };

            utterance.onend = () => {
                character.textContent = 'ğŸ˜€'; // ëë‚˜ë©´ ê¸°ë³¸ ì–¼êµ´ ëª¨ì–‘ìœ¼ë¡œ ëŒì•„ê°€ê¸°
            };

            window.speechSynthesis.speak(utterance);
        });
    </script>
</body>
</html>
