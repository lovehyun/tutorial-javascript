<!-- views/layout.html -->
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>{% block title %}My Website{% endblock %}</title>
        <style>
            body {
                margin: 0;
                font-family: Arial, sans-serif;
            }

            nav {
                background-color: #333;
                overflow: hidden;
            }

            nav ul {
                list-style-type: none;
                margin: 0;
                padding: 0;
                overflow: hidden;
            }

            nav li {
                float: left;
            }

            nav a {
                display: block;
                color: white;
                text-align: center;
                padding: 14px 16px;
                text-decoration: none;
                transition: background-color 0.3s;
            }

            nav a:hover {
                background-color: #ddd;
                color: black;
            }

            .user-info {
                float: right;
                color: white;
                padding: 14px 16px;
            }

            .logout-btn {
                cursor: pointer;
                color: white;
                padding: 0;
                text-decoration: underline;
            }
        </style>

        {% block head %}{% endblock %}
    </head>
    <body>
        <nav>
            <ul>
                <li><a href="/">Home</a></li>
                <li><a href="/products">Products</a></li>
                <li><a href="/cart">Cart</a></li>
                <div class="user-info">
                    {% if user %}
                        {{ user.username }} 님
                        <span class="logout-btn" onclick="logout()">Logout</span>
                    {% endif %}
                </div>
            </ul>
        </nav>

        <div>
            {% block content %}{% endblock %}
        </div>

        <script>
            function logout() {
                fetch('/api/logout', { method: 'GET' })
                    .then((response) => response.json())
                    .then((data) => {
                        alert(data.message);
                        if (data.redirectUrl) {
                            // 리다이렉트 URL이 존재하는 경우 페이지를 이동
                            window.location.href = data.redirectUrl;
                        } else {
                            // 리다이렉트 URL이 없는 경우 페이지를 새로고침
                            window.location.reload();
                        }
                    });
            }
        </script>

        {% block scripts %}{% endblock %}
    </body>
</html>
